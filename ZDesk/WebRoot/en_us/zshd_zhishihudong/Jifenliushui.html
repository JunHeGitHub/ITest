<!DOCTYPE  HTML>
<html lang="en">
  <head>
    <title>Jifenliushui.html</title>
	
            <meta http-equiv="keywords" content="keyword1,keyword2,keyword3">
            <meta http-equiv="description" content="this is my page">
            <meta http-equiv="content-type" content="text/html; charset=UTF-8">
            <link rel="stylesheet" href="../../css/bootstrap.min.css" type="text/css"></link>
		    <link rel="stylesheet" href="../../css/bootstrap-responsive.min.css" type="text/css"></link>
			<link rel="stylesheet" href="../../js/dataTables/css/jquery.dataTables.css" type="text/css"></link>
			
			<!-- bootstrap 与 datatable结合 -->
			<link rel="stylesheet" href="../../js/dataTables/css/DT_bootstrap.css" type="text/css"></link>
			<!-- 工具 -->
			<link rel="stylesheet" href="../../js/dataTables/css/dataTables.tableTools.min.css" type="text/css"></link>
			<!-- 动态列CSS -->
			<link rel="stylesheet" href="../../demo/unicorn.main.css" type="text/css"></link>
		    <link rel="stylesheet" href="../../js/dataTables/css/font-awesome.css"></link>
			<link rel="stylesheet" href="../../js/dataTables/css/dataTables.colVis.min.css" type="text/css"></link>
			<script type="text/javascript" src="../../js/golbal_params.js"></script>
			<script type="text/javascript" src="../../js/jquery.js"></script>
			<script type="text/javascript" src="../../js/bootstrap.js"></script>
			<script type="text/javascript" src="../../js/dataTables/js/jquery.dataTables.js"></script>
			<script type="text/javascript" src="../../js/dataTables/js/dataTables.colReorder.js"></script>
			<script type="text/javascript" src="../../js/dataTables/js/dataTables.colVis.js"></script>
			<script type="text/javascript" src="../../js/dataTables/js/dataTables.tableTools.min.js"></script>
			<script type="text/javascript" src="../../js/dataTables/js/DT_bootstrap.js"></script>
			<script type="text/javascript" src="../../js/common_utils.js"></script>
			<script type="text/javascript" src="../../js/appCommonUtil.js"></script>
			<script type="text/javascript" src="../../js/appCommonCurdUtils_new.js"></script>
			<script type="text/javascript" src="../../js/comWindow/jquery-ui.min.js"></script>
			<script type="text/javascript" src="../../js/bootstrap-datetimepicker/bootstrap-datetimepicker.js"></script>
			<link rel="stylesheet" href="../../js/bootstrap-datetimepicker/css/bootstrap-datetimepicker.min.css" type="text/css"></link>
			<link rel="stylesheet" href="../../js/comWindow/window.css" type="text/css"></link>
			<link rel="stylesheet" href="../../js/comWindow/jquery-ui.min.css" type="text/css"></link>
			<script type="text/javascript" src="../../js/comWindow/window.js"></script>

    <!--<link rel="stylesheet" type="text/css" href="./styles.css">-->

		<style type="text/css" class="init"> 
#dictbody td.red {
	font-weight: bold;
	color: red;
}
 
#dictbody td {
	text-align: center;
}
 
/* fa-square-o */
#dictbody tr td:first-child:before {
	content: "\f096";
	font-family: FontAwesome;
}
 
#dictbody tr.active td:first-child:before {
	content: "\f046"; /* fa-check-square-o */
}
</style>
		<script type="text/javascript">
		
var ww ;
var CHECK_indexCode=false ;
var CHECK_code=false ;
var bool=true;
var CHECK_name=false;
var roleWin;
var orgWin;
function addOrg() {		
			var url = "/ZDesk/zh_cn/common/zkmCommonTree.html?recordType=menu&type=allNode&mode=single&showButton=y&reFillFn=getOrgCodeList&closeFn=closeWindow";
			$("#orgWin iframe").attr("src", url).removeClass('hide');
			orgWin.open();
		}
		
// 关闭window
function closeWindow() {
	roleWin.close();
	orgWin.close();
}
$(document).ready(function() {
	   loginName=getUserInfo().loginName;
	   userName=getUserInfo().name;
	   $("#beginTime").datetimepicker({format:'yyyy-mm-dd hh:ii' ,minuteStep:1});
	   $("#endTime").datetimepicker({format:'yyyy-mm-dd hh:ii' ,minuteStep:1});
	   data=doSearch(); 
       
	  $('#test').dataTable({
    	    //滚动条 
	        // scrollY: 500,
	        // scrollX: true,
	        bPaginate: true, //翻页功能
			bLengthChange: false, //改变每页显示数据数量
			bFilter: false, //过滤功能
			bSort: true, //排序功能
			bInfo: true,//页脚信息
			bAutoWidth: false, //自动宽度
			sPaginationType: "bootstrap",//分页样式
			data:data,
		    dom: 'TRlrtip',
	        order: [ 1, 'desc' ],
			columns: [
			//	{  title:"<input type='checkbox' id='selectall' onclick='toggleChecks(this);' ></input>",data: null, defaultContent: '', orderable: false },
				{ 
				  title:"id" ,
				  data: 'id',
				  visible: false,
				  searchable: false
				},
				/**title 表头  data json 对应key **/
				    {"title":"主键ID",data: 'id',"bVisible": false},
		            {"title":"登录名" ,data: 'loginName'},
			        {"title":"用户名",data:'userName'},
			        {"title":"积分",data: 'integralNum'},	       
			        {"title":"积分时间",data: 'integralTime'},
			        {"title":"问题序号",data: 'questionId',"bVisible": false}            
	        ],
	        //列 行高亮显示
	        createdRow: function ( row, data, index ) {
	           $('td', row).eq(2).addClass('red');
	        } ,
	        //列筛选等属性 样式 可以与columns属性合并
	        columnDefs: [ {
			     "targets": -1,
			     "defaultContent": "<button>编辑</button>",
			      data:null
		          } ,
		          {
	                render: function ( data, type, row ) {
	                    return data ;//+' (单元格格式化)';
	                },
	                "targets": 3
	            }
		    ],
	        oLanguage: {
				"sLengthMenu": "每页显示 _MENU_条",
				"sZeroRecords": "没有找到符合条件的数据",
				"sProcessing": "&lt;imgsrc=’./loading.gif’ /&gt;",
				"sInfo": "当前第 _START_ - _END_ 条　共计 _TOTAL_ 条",
				"sInfoEmpty": "木有记录",
				"sInfoFiltered": "(从 _MAX_ 条记录中过滤)",
				"sSearch": "搜索：",
				"oPaginate": {
				"sFirst": "首页",
				"sPrevious": "前一页",
				"sNext": "后一页",
				"sLast": "尾页"
			    }
	        }, tableTools: {
	            aButtons:     [ ],
	   }  
	 });  
	 //绑定事件
	     var table= $('#test').DataTable();
		    $('#test tbody').dblclick('click',function(e){
			});
 }); 
//查询表格内容
var ZKM_ROU="ZKM";
  function doSearch(data){
		//通用查询action路径
		var url="/"+window.top.PRJ_PATH+"/"+ZKM_ROU+"/"+"LH"+"/"+"searchIntegral.action";
		   var rdata=[];
		   	$.ajax({
				async :false,
				type : "post",
				url : url,
				dataType : "json",
				data : data,
				success : function(data) {
					if (data) {
		              rdata=data.data;
					}
				},
				error : function(r){
				   alert("error");			
				}
				});
		     return rdata;
		}
  

//点击查询按钮  查询表单所对应的数据	
function btsearch(){
    var data=zkm_getHtmlFormJsons("where"); 
    if(data!=''||data!=null||data!=undefined){
        startDate=$('#beginTime').val();
        endDate=$('#endTime').val();
        var diffDay=U_DateDiffer(U_BuildDate(startDate),U_BuildDate(endDate))/24;
        if(diffDay<=90){
            var info=doSearch(data);
            var table=$('#test').DataTable();
		    table.clear().draw();
		    table.rows.add(info).draw();
		}else{
		    zinglabs.i18n.alert('zshd_queryTimeInThreeMonth');
		}
	  }else{
	      zinglabs.i18n.alert('zshd_inputQueryCondition');
	}   
}
//重置
function reset(form){
	var cfs=$("#"+form+" input[name],textarea[name]");
	for(var i=0;i<cfs.length;i++){
		var e=cfs[i];	
	    $(e).val(''); 
	}
	$("#"+form+"")[0].reset();
}
 //刷新
	function refresh(){
	    loginName=getUserInfo().loginName;
	    var table=$('#test').DataTable();
	     //清空筛选
	     table.search("").draw();
	     //清空数据
	     table.clear().draw();
	     //重新加载数据
	      var data=doSearch(); 
	      table.rows.add(data).draw(true);
	}

</script>




</head>
  <body style="width: auto;">
<!-- 头 -->
<div class="widget-box collapsible" style="margin-top:0px">
	<div class="widget-title">
       <span class="icon">
			<i class="icon-search"></i>
		</span>
		<h5>搜索表单</h5>
		<div class="buttons">
			<!-- <div id="cols" ></div> -->
		   <a href="#collapseOne" data-toggle="collapse" class="btn btn-mini"><i class="icon-retweet"></i>展开/关闭</a></div>
		</div>
		<div class="collapse in" id="collapseOne" style="height:50px">
			<div class="widget-content"  style="width: 1300px;height:30px">
				<form action="" id="where">
					<div class="row">
					     <div class="span4">
							<div class="control-group"style="margin-left:10px;margin-top:5px">
							   <label class="control-label">用户：</label>
							   <div class="controls" style="margin-left:50px;margin-top:-30px">
									<input type="text" id="loginName"  name="loginName" placeholder="">
							   </div>
						    </div>
						 </div>
	                     <div class="span4">
							<div class="control-group"style="margin-left:20px;margin-top:5px">
							   <label class="control-label" style="margin-left:-50px">积分时间段：</label>
							   <div class="controls  input-append date form_datetime" style="margin-left:40px;margin-top:-40px" data-picker-position="bottom-left" data-link-field="beginTime" >
									<input type="text" id="beginTime"  name="beginTime" placeholder="" style="width:180px">
                                     <span class="add-on"><i class="icon-th"></i></span>   
							   </div>
						       <label class="control-label" style="margin-left:270px;margin-top:-45px">至：</label>
						       <div class="controls  input-append date form_datetime" style="margin-top:0px" data-picker-position="bottom-left" data-link-field="endTime" >
								  <input type="text" id="endTime"  name="endTime" placeholder="" style="width:180px;margin-left:300px;margin-top:-30px">
                                   <span class="add-on" style="margin-top:-30px"><i class="icon-th"></i></span>   
							   </div>
							</div>
						 </div> 
						
					</div>
					</form>
		</div>
		</div>
			<div class="widget-box collapsible">
		<div class="widget-title">
					&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	每页显示条数：
			<select name="pageSize" id="pageSize" style="width:70px" onchange="setPageNum(this)">
				<option selected="selected" value="10">
					10
				</option>
				<option value="30" >
					30
				</option>
				<option value="50" >
					50
				</option>
				<option value="100" >
					100
				</option>
				<option value="200" >
					200
				</option>
				<option value="500" >
					500
				</option>
				<option value="1000" >
					1000
				</option>
				<option value="-1" >
					全部
				</option>
			</select>
			<button type="button" class="btn" onclick="btsearch()"><i class="icon-search"></i> 搜 索</button>
			<button type="button" class="btn" onclick="reset('where')"><i class="icon-repeat"></i> 重置</button>
			<button type="reset" class="btn" onclick="refresh()"><i class="icon-refresh"></i>刷新</button>
		</div>
</div>			
	<!-- class 或 = display -->
	<table style="float: left;margin-top:0px" class="table table-striped table-bordered"
		id="test" cellspacing="0">
	</table>

   		<div id="roleWin">
			<iframe src="" style="border: 0; width: 95%; height: 95%" class="hide"></iframe>
		</div>
		<div id="orgWin">
			<iframe src="" style="border: 0; width: 95%; height: 95%" class="hide"></iframe>
		</div>
</body>
  
 	
 	

</html>
