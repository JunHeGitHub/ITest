<!DOCTYPE  HTML>
<html lang="en">
	<head>
		<title>我要提问</title>

		<meta http-equiv="keywords" content="keyword1,keyword2,keyword3" />
		<meta http-equiv="description" content="this is my page" />
		<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
		<link rel="stylesheet" href="../../css/bootstrap.css" type="text/css"></link>
		<link rel="stylesheet" href="../../js/dataTables/css/jquery.dataTables.css" type="text/css"></link>

		<!-- 工具 -->
		<link rel="stylesheet" href="../../js/bootstrap-datetimepicker/css/bootstrap-datetimepicker.min.css" type="text/css"></link>
		<link rel="stylesheet"href="../../js/dataTables/css/dataTables.tableTools.min.css"type="text/css"></link>
		<!-- bootstrap 与 datatable结合 -->
		<link rel="stylesheet" href="../../js/dataTables/css/DT_bootstrap.css" type="text/css"></link>
		<link rel="stylesheet" href="../../js/dataTables/css/font-awesome.css"></link>
		<link rel="stylesheet" href="../../js/dataTables/css/Z_DataTalbeCheckBox.css"></link>
		<link rel="stylesheet" href="../../js/dataTables/css/dataTables.colVis.min.css" type="text/css"></link>
		<script type="text/javascript" src="../../js/jquery.js"></script>
		<script type="text/javascript" src="../../js/bootstrap.js"></script>
		<script type="text/javascript" src="../../js/common_utils.js"></script>
		<script type="text/javascript" src="../../js/dataTables/js/jquery.dataTables.js"></script>
		<script type="text/javascript" src="../../js/dataTables/js/dataTables.colReorder.js"></script>
		<script type="text/javascript" src="../../js/dataTables/js/dataTables.colVis.js"></script>
		<script type="text/javascript" src="../../js/dataTables/js/dataTables.tableTools.min.js"></script>
		<script type="text/javascript" src="../../js/dataTables/js/DT_bootstrap.js"></script>
		<script type="text/javascript" src="../../js/golbal_params.js"></script>
		<script type="text/javascript" src="../../js/appCommonUtil.js"></script>
		<script type="text/javascript" src="../../js/html5.js"></script>
		<script type="text/javascript" src="../../js/appCommonCurdUtils_new.js"></script>
		<script type="text/javascript" src="../../js/bootstrap.min.js"></script>
		<script type="text/javascript" src="../../js/bootstrap-datetimepicker/bootstrap-datetimepicker.js"></script>
		<style type="text/css">
	.orderDiv {
	padding-left: 2px;
	border: 1px solid #33AECC;
	border-collapse: separate;
	border-left-width: 1px;
	border-right-width: 1px;
	border-right-color: #33AECC;
	cellspacing: 0px;
	cellpadding: 0px;
	min-height: 100px;
	padding-bottom: 1px;
	margin-left: 0px;
	margin-top:0px;
    *zoom: 1;
}
.btn{
	margin-top: -54px;
	margin-left: 175px;
}
		</style>

		<script type="text/javascript">
		$(document).ready(function() {
		getTimes();
		getTimeYM();
		num =timeYM+"000000000000";
		number=getTimeNumber(getNumber());
		$("#questionId").val(number);
	    name=getUserInfo().name;
		$("#userName").val(name);
		$("#suggestTime").val(strTime);
		 comType('jianyiqudao');
		 
		});
		//获取系统时间精确到月
		var timeYM=""
		function getTimeYM(){
		  var d=new Date();
          timeYM +=d.getFullYear(); //获取当前年份 
 
          if((""+d.getMonth()).length==2)
          timeYM +=d.getMonth()+1;
          else
          timeYM +="0"+d.getMonth()+1;
          return timeYM;
		 }
//获取系统时间精确到分
		 var strTime="";
		 function getTimes(){
  var d=new Date();
  strTime +=d.getFullYear()+"-"; //获取当前年份 
 
 if((""+d.getMonth()).length==2)
 strTime +=d.getMonth()+1+"-";
 else
 strTime +="0"+d.getMonth()+1+"-";

  if((""+d.getDate()).length==2)
 strTime +=d.getDate()+"-";
 else
 strTime +="0"+d.getDate()+"-";
 
  if((""+d.getHours()).length==2)
 strTime +=d.getHours()+":";
 else
 strTime +="0"+d.getHours()+":";
 
 if((""+d.getMinutes()).length==2)
 strTime +=d.getMinutes();
 else
 strTime +="0"+d.getMinutes();
 
 return strTime;
}
		//获取系统时间精确到秒
		function getTime(){
  var d=new Date(),str="";
  str +=d.getFullYear(); //获取当前年份 
 
 if((""+d.getMonth()).length==2)
 str +=d.getMonth()+1;
 else
 str +=""+d.getMonth()+1;

  if((""+d.getDate()).length==2)
 str +=d.getDate();
 else
 str +="0"+d.getDate();
 
  if((""+d.getHours()).length==2)
 str +=d.getHours();
 else
 str +="0"+d.getHours();
 
 if((""+d.getMinutes()).length==2)
 str +=d.getMinutes();
 else
 str +="0"+d.getMinutes();
 
 if((""+d.getSeconds()).length==2)
 str +=d.getSeconds();
 else
 str +="0"+d.getSeconds();
 return str;
}
//查询questionId的值
function getNumber(){
				var pat={};
		        var rdata="";
		        pat.columnValues={};
		        pat.isPagination=false;
	            pat.tableName = "question";
	            pat.columnValues.questionId=num;
	            pat.columns="questionId";
	            pat.moreThan={"questionId":"questionId"};
			    commonSelect(pat,false,function(data){
			                if(data&&data.data){
			                  rdata=data.data;
		                }
		    });
  return rdata;
}
//获取系统时间并生成序号
function getTimeNumber(getNumber1){
   if(getNumber1[0]==null){
      return getTime()+"0001";
   }
   var number=getNumber1[getNumber1.length-1].questionId.substr(14,4)*1+1;
   var l=number.length;
   if (number<1000){
        do{
		  number="0"+number;
		}while(number.length<4);
   }
   var timeNumber=getTime()+(number);
   return timeNumber;
}
//加载字典项
function comType(selectid){
			var data=getDictListfoIndexData(selectid);
			$("#"+""+selectid+"").empty();
				$("#"+""+selectid+"").append("<option value=''>--请选择--</option>"); 
			for(var i in data){
	        	$("#"+""+selectid+"").append("<option value='"+data[i].name+"'>"+data[i].name+"</option>"); 
	        }
 }
 //添加组织分类
 function orgDialog(url) {
	var orgDig = dialog({
				title : '组织机构',
				content : '<iframe src=' + url
						+ ' style="border: 0; width: 100%; height: 100%"  frameborder="0"/>',
				width : '300',
				height : '400'
			});
	orgDig.show();
	return orgDig;
}
function addOrg() {
	var url = "/ZDesk/zh_cn/common/zkmCommonTree.html?recordType=org&type=test&mode=many&showButton=y&reFillFn=getOrgCodeList&closeFn=closeDig";
	closeDialog=orgDialog(url);
}
function getOrgCodeList(orgCodeList) {
	var str = '';
	$("#companyCodeList").val(orgCodeList);
	for (var i = 0; i < orgCodeList.length; i++) {
		var params = {};
		params.columnValues={};
		params.tableName = "commonTree_detail";
		params.columnValues.id=orgCodeList[i];
		params.equal="id";
	    commonSelect(params,false,function(data){
			                if(data&&data.data){
			                  str = data.data[0].text + "," + str;;
		                }

		    });
	}
	var companyTextList = str.substr(0, str.length - 1);
	$("#placeGroup").val(companyTextList);
	closeDig();
}
//关闭dialog
function closeDig(){
	window.closeDialog.close().remove();
}
//提交
function save(){
	loginName=getUserInfo().loginName;
	$("#loginName").val(loginName);
	var pat={};
	var columnValues={};
	pat.tableName="question";
	pat.columnValues=zkm_getHtmlFormJsons("addAndUpdateForm");
	pat.primarykeyType="uuid";
	commonInsertOrUpdate(pat,false,function(data){
		if(data.success==true){
			zinglabs.i18n.alert('system_saveSuccess');
		}
	});
}


			</script>

	</head>
	<body>
		<!-- 头部导航条 -->
		<!-- 数据表格展示模块 开始 -->
		
		<!-- 功能按钮模块 结束 -->

			<!-- 栅格布局 -->
			<div id="addAndUpdate" class="orderDiv"
				style=" border: 2px solid #33AECC;">
				<div id="wenti"class="orderDiv" style=" margin-left: -5px;">
				<form class="form-horizontal" id="addAndUpdateForm">
					<div style="margin-left: 5px;">
							<h6>
								我的问题
							</h6>
					<input type="hidden" id="id" name="id" />
					<input type="hidden" id="loginName" name="loginName" />
					  <div class="row">
	                         <div class="span4" style="margin-left: -40px;">
									<div class="control-group ">
										<label class="control-label">
											序号:
										</label>
										<div class="controls">
										<input style="width: 160px; border-bottom-color:black; border-left:0px;border-right:0px;border-top:0px;background-color: white;" type="text" id="questionId" name="questionId" readonly="readonly"/>
										</div>
									</div>
								</div>
								<div class="span10"style="margin-left: -40px;">
									<div class="control-group ">
										<label class="control-label">
											标题:
										</label>
										<div class="controls ">
											<input type="text" style="width: 480px;border-bottom-color:black; border-left:0px;border-right:0px;border-top:0px;background-color: white;" id="title"
												name="title" />
										</div>
									</div>
								</div>
								<div class="span4" style="margin-left: -40px;">
									<div class="control-group ">
										<label class="control-label">
											建议人:
										</label>
										<div class="controls">
											<input type="text" style="width: 160px" id="userName"
												name="userName" readonly="readonly"/>
										</div>
									</div>
								</div>
								<div class="span4">
									<div class="control-group ">
										<label class="control-label">
											建议时间:
										</label>
										<div class="controls">
											<input type="text" style="width: 160px" id="suggestTime" name="suggestTime" readonly="readonly"/>
										</div>
									</div>
								</div>
								<div class="span4"style="margin-left: -40px;">
									<div class="control-group ">
										<label class="control-label">
											建议渠道:
										</label>
										<div class="controls">
											<select id="jianyiqudao" name="suggestChannel" style="width: 160px" >
											</select>
										</div>
									</div>
								</div>
								<div class="span4" >
									<div class="control-group ">
										<label class="control-label">
											业务分类:
										</label>
										<div class="controls">
											<input type="text" style="width: 160px" id="classification"
												name="classification" />
										</div>
									</div>
								</div>
								<div class="span4"style="margin-left: -40px;">
									<div class="control-group ">
										<label class="control-label">
											工单编号:
										</label>
										<div class="controls">
											<input type="text" style="width: 160px" id="orderNumber"
												name="orderNumber" />
										</div>
									</div>
								</div>
								<div class="span4">
									<div class="control-group ">
										<label class="control-label">
											所在专组:
										</label>
										<div class="controls">
											<input type="text" style="width: 160px" id="placeGroup"
												name="placeGroup" readonly />
											<span id="btn_suSecurityUser_xuanze"><input type="button" class="btn" onclick="addOrg()" value="选择"></span>
										</div>
										<input type="hidden" id="companyCodeList">
									</div>
								</div>
								<div class="span4" style="margin-left: -40px;">
									<div class="control-group ">
										<label class="control-label">
											建议/工单内容:
										</label>
										<div class="controls">
											<textarea id="suggestContent" name="suggestContent"
								style="width: 160px; height: 55px;"></textarea>	
										</div>
									</div>
								</div>
							</div>
						</div>
				</form>
			</div>
		</div>
		
		<div class="widget-box collapsible" style="margin-top: -10px;">
			<div class="widget-title"
				style="height: 40px; line-height: 40px; overflow: hidden;">
				<span class="icon" style="float: left; padding: 0px 10px;"><i
					class="icon-cog"></i> </span> &nbsp;&nbsp;&nbsp;
				<button type="button" class="btn" style="margin-top:0px; margin-left: 600px;" onclick="save();">
					<i class="icon-ok"></i>提 交
				</button>
			</div>
		</div>
	</body>
</html>