<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<title>角色授权--添加</title>

		<meta http-equiv="keywords" content="keyword1,keyword2,keyword3" />
		<meta http-equiv="description" content="this is my page" />
		<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
		<meta http-equiv=”X-UA-Compatible” content=”IE=EmulateIE8″ />
		<link rel="stylesheet" href="../../../css/bootstrap.min.css" type="text/css"></link>
		<link rel="stylesheet" href="../../../css/bootstrap-responsive.min.css"
			type="text/css"></link>
		<!-[if IE]>
		<!-- script src=”http://html5shiv.googlecode.com/svn/trunk/html5.js”></script> -->
		<![endif]–>
		<!-- bootstrap 与 datatable结合 -->
		<!-- 动态列CSS -->
		<link rel="stylesheet" href="../../../demo/unicorn.main.css" type="text/css"></link>
		<link rel="stylesheet"
			href="http://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.0.3/css/font-awesome.css"></link>
		<script type="text/javascript" src="../../../js/jquery.js"></script>
		<script type="text/javascript" src="../../../js/bootstrap.js"></script>
		<script type="text/javascript" src="../../../js/common_utils.js"></script>
		<script type="text/javascript">
var data_getRoleByloginName;
var loginname;
var pwin = window.parent
//下拉框交换JQuery
$(function(){
     var data_all=doSearch();
     var select1 = $("#select1"); 
      select1.empty();//清空select下拉框

    for(var i=0;i<data_all.length;i++){
        $("<option value='" + data_all[i].id + "'>" + data_all[i].name + "</option>").appendTo(select1)//动态添加Option子项
    }
     data_getRoleByloginName=doSearch_getRoleByloginName();
     var select2 = $("#select2"); 
      select2.empty();//清空select下拉框

    for(var i=0;i<data_getRoleByloginName.length;i++){
        $("<option value='" + data_getRoleByloginName[i].id + "'>" + data_getRoleByloginName[i].name + "</option>").appendTo(select2)//动态添加Option子项
    }
       
    //移到右边
    $('#add').click(function() {
      //获取选中的选项，删除并追加给对方
        var array = new Array(); //定义数组
        $("#select2 option").each(function(){ //遍历全部option
        var txt = $(this).val(); //获取option的内容
            array.push(txt); //添加到数组中
        });
       var sid=$('#select1 option:selected').val();
       if($.inArray(sid, array)==-1){
          $('#select1 option:selected').appendTo('#select2');
       }
        
    });
     //双击选项
    $('#select1').dblclick(function(){ //绑定双击事件
        //获取全部的选项,删除并追加给对方
        $("option:selected",this).appendTo('#select2'); //追加给对方
    });
    //双击选项
    $('#select2').dblclick(function(){
       $("option:selected",this).appendTo('#select1');
    });
    //移到左边
    $('#remove').click(function() {
        $('#select2 option:selected').appendTo('#select1');
    });
    /**
    //全部移到右边
    $('#add_all').click(function() {
        //获取全部的选项,删除并追加给对方
        $('#select1 option').appendTo('#select2');
    });
    //全部移到左边
    $('#remove_all').click(function() {
        $('#select2 option').appendTo('#select1');
    });
   **/             
});

function doSearch(){	
		//通用查询action路径
		   var url = "/" + "ZDesk" + "/" + "ZKM/CommonsCurd" + "/" + "Find.action";		
		   var params={};
		   params.tableName ="suSecurityRole";
		   params.nameSpace ="com.zinglabs.apps.commons.pojo";
		   params.nameSpaceId = "getList";
		   var rdata=[];
		   	$.ajax({
				async :false,
				type : "post",
				url : url,
				dataType : "json",
				data : params,
				success : function(data) {
					if (data) {
		              rdata=data.rows;
					}
				}
				});
		     return rdata;
		}
						
		function doSearch_getRoleByloginName(){	
		 loginname=getQueryString("loginName");
		//通用查询action路径
		  var url = "/" + "ZDesk" + "/" + "ZKM/RoleCurd" + "/" + "getRoleByLoginName.action?loginName="+loginname;
		    var params={};
		    //params.tableName ="suSecurityUserAndRole";
	        params.nameSpace ="com.zinglabs.apps.suPermission";
		    params.nameSpaceId = "getRoleByLoginName";		    
		   var rdata=[];
		   	$.ajax({
				async :false,
				type : "post",
				url : url,
				dataType : "json",
				data : params,
				success : function(data) {
					if (data) {
		              rdata=data.rows;
					}
				}
				});
		     return rdata;
		}
		
		
		function doSave(){
		var reFillFn = getQueryString("reFillFn");
		var array = new Array(); //定义数组
        $("#select2 option").each(function(){ //遍历全部option
        var txt = $(this).val(); //获取option的内容
            array.push(txt); //添加到数组中
        });
        pwin[reFillFn](array);
		}
</script>
	</head>
	<body>
		<br />
		<br />
		<table width="700" align="center" border="0" cellpadding="0"
			cellspacing="0" class="newContTab">
			<tr>
				<th>
				</th>
				<td>
					<div>
						<div>
							<select multiple="multiple" id="select1"
								style="width: 300px; height: 200px; float: left;">
							</select>
						</div>
						<div style="float: left">
							<br />
							<br />
							<br />
							<span id="add"> <input type="button" class="btn"
									value="》》" /> </span>
							<br />
							<span id="remove"> <input type="button" class="btn"
									value="《《" /> </span>
							<br />
						</div>
						<div>
							<select multiple="multiple" name="s" id="select2"
								style="width: 300px; height: 200px; float: left;">
							</select>
						</div>
					</div>
				</td>
			</tr>
			<tr>
				<th>
				</th>
				<td>
					<div>
						<div>
							<span style="width: 300px; height: 30px; float: left;"> </span>
						</div>
						<div style="float: left">
							<span>
								<button type="button" class="btn btn-default"
									style="width: 70px" data-toggle="modal" onclick="doSave()">
									提交
								</button> </span>
						</div>
						<div>
							<span style="width: 300px; height: 30px; float: left;"> </span>
						</div>
					</div>
				</td>
			</tr>
		</table>
	</body>
</html>