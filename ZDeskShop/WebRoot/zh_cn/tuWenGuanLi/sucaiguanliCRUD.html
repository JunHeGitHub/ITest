<!DOCTYPE  HTML>
<html lang="en">
	<head>
		<title></title>

		<meta http-equiv="keywords" content="keyword1,keyword2,keyword3" />
		<meta http-equiv="description" content="this is my page" />
		<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
		<link rel="stylesheet" href="../../css/bootstrap.css" type="text/css"></link>
		<link rel="stylesheet"
			href="../../js/bootstrap-datetimepicker/css/bootstrap-datetimepicker.min.css" type="text/css"></link>

		<link rel="stylesheet"
			href="../../js/dataTables/css/jquery.dataTables.css" type="text/css"></link>

		<!-- 工具 -->
		<link rel="stylesheet"
			href="../../js/dataTables/css/dataTables.tableTools.min.css"
			type="text/css"></link>
		<!-- bootstrap 与 datatable结合 -->
		<link rel="stylesheet" href="../../js/dataTables/css/DT_bootstrap.css"
			type="text/css"></link>
		<link rel="stylesheet" href="../../js/dataTables/css/font-awesome.css"></link>		
		<link rel="stylesheet"
			href="../../js/dataTables/css/dataTables.colVis.min.css"
			type="text/css"></link>
<link rel="stylesheet" href="../../css/zinglabs.css" type="text/css" />
		<script type="text/javascript" src="../../js/jquery.js"></script>
		<script type="text/javascript" src="../../js/bootstrap.js"></script>
		<script type="text/javascript" src="sucaiguanliCRUD.js"></script>
		<script type="text/javascript" src="../../js/common_utils.js"></script>
		<script type="text/javascript"
			src="../../js/dataTables/js/jquery.dataTables.js"></script>
		<script type="text/javascript"
			src="../../js/dataTables/js/dataTables.colReorder.js"></script>
		<script type="text/javascript"
			src="../../js/dataTables/js/dataTables.colVis.js"></script>
		<script type="text/javascript"
			src="../../js/dataTables/js/dataTables.tableTools.min.js"></script>
		<script type="text/javascript"
			src="../../js/dataTables/js/DT_bootstrap.js"></script>
		<script type="text/javascript" src="../../js/golbal_params.js"></script>
		<script type="text/javascript" src="../../js/appCommonUtil.js"></script>
		<script type="text/javascript" src="../../js/appCommonCurdUtils_new.js"></script>
		<script type="text/javascript" src="../../js/html5.js"></script>
		<script language=javascript src='../../js/artdialog/dialog-plus.js'></script>
<script type="text/javascript" src="../../js/log2.js"></script>
		<!-- 遮罩产插件 -->
		<script type="text/javascript" src="../../js/jquery.blockUI.js"></script>
		<!-- 验证及提示组件 -->
		<script type="text/javascript"
			src="../../js/jqueryValidate/jquery.validate.js"></script>
		<link rel="stylesheet" href="../../js/darktooltip/css/darktooltip.css"
			type="text/css"></link>
		<script type="text/javascript"
			src="../../js/darktooltip/js/jquery.darktooltip.js"></script>
				<style type="text/css">
/*解决时间控件在模式对话框中的显示问题**/
.error {
	border-color: red !important;
}

.datetimepicker {
	z-index: 99999 !important;
}

.bootstrap-datetimepicker-widget {
	z-index: 99999 !important;
}

/*临时解决datatable单元格变形问题  为保证宽度不变，ie兼容模式显示效果为换行 其它浏览器省略号
  需要通过只显示部分原文解决此问题
*/
.dataTable th,.dataTable td {
	max-width: 120px;
	overflow: hidden;
	text-overflow: ellipsis;
	white-space: nowrap;
}
</style>
		<script type="text/javascript">
var maskContent = {
		css : {
			border : 'none',
			padding : '15px',
			backgroundColor : '#000',
			'-webkit-border-radius' : '10px',
			'-moz-border-radius' : '10px',
			opacity : .5,
			color : '#fff',
			font : '14px'
		},
		message : '<img src="../../img/wait.gif" border="0" />  正在加载中，请稍候...'
	};
var closeDialog;
		
		
		
		$(document).ready(function() {
 getGroup();
   $.blockUI(maskContent);    
   
			
			$('#zuoxipeixun').DataTable({
			//滚动条
        //scrollY: 500,
        //scrollX: false,
        //延迟加载
         deferRender: true,
         processing: false,  
         //开启服务端分页
         serverSide: true,
        
         //服务器端分页ajax请求 可抽离出一个方法
       ajax: function (data, callback, settings) {
                var params=spellSelectParams("find");
			    params.tableName="graphicInformationManager";
			    params.rows=settings._iDisplayLength;
			    params.offset=settings._iDisplayStart;
			    params.columnValues.parentId = 0;
	params.columnValues.Category=params.columnValues.Category1;
	params.like.Category="Category";
	delete params.columnValues.Category1;
	delete params.like.Category1;
	params.equal.parentId="parentId";
	params.orderBy="dataTime desc";
			    $.blockUI(maskContent);
			    commonSelect(params,true,function(data){
			          try{
			              if(data&&data.data){
			                  var pdata={};
			                  var size=data.data.length;
			                  for(var i=0;i<size;i++){
			                    data.data[i].DT_RowNumber=i+1;
			                  }
			                  //数据
			                  pdata.data=data.data;
			                  //总条数
			                  pdata.recordsTotal=data.total||0;
			                   //过滤没有使用到总条数
			                  pdata.recordsFiltered=data.total||0;
			                  // 代表第几次画页面  如pdata.draw 不能删 如删掉不会翻页  
			                  pdata.draw=settings.iDraw;
			                  callback(pdata);
			                }
			          }catch(ex){
			             logErr("查询失败 failed "+ex.name + ": " + ex.message);
			          }  
			          $.unblockUI();    
			    });
		 
		},
		pagingType: "full_numbers",
        pageLength: 10,
        bPaginate: true, //翻页功能
        bLengthChange: true, //改变每页显示数据数量
        bFilter: true, //过滤功能
        bSort: true, //排序功能
        bInfo: true,//页脚信息
        bAutoWidth: false, //自动宽度
        sPaginationType: "bootstrap",//分页样式
        dom: 'TRlrtip',
        
        columns: [
              {title:"序号",data: "DT_RowNumber", defaultContent: '', width:'1%',orderable: false },
					/**title 表头  data json 对应key **/
					{
			          "title":"操作",
			          data:"id",
					  "sClass": "center",
					  "bSearchable": false,
					  "bStorable": false,width:'2%'
					 },
			        {"title":"标题" ,data: 'title',width:'5%'},
			        {"title":"作者",data:'autor',width:'5%'},
			       {"title":"原文链接",data:'originalLink',width:'9%'},
			        {"title":"图文类型",data: 'singleOrDouble',width:'4%'},
			         {"title":"所属类别",data:'Category',width:'4%'},
			         {"title":"是否发布",data:'isRelease',width:'4%'},
			         {"title": "时间",data: 'dataTime',width:'6%'},
					{ title:"标识" ,data: 'id',visible: false,searchable: false}
		        ],
        "aoColumnDefs":[{"aTargets":[1],"mRender":function(data,type,full){                     
		         return "&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"#myModal-edit\" data-toggle=\"modal\" onclick=\"pf('"+data+"')\"> <i class=\"fa fa-lg-2 fa-pencil\"> </i> </a> "
		         }                    
		         }],
        columnDefs: [ {
            "searchable": false,
            "orderable": false,
            "targets": 0
        } ],
		        
		        
		        
		        
		        oLanguage: {
infoFiltered:function(){
             
             },
					"sLengthMenu": "每页显示 _MENU_条",
					"sZeroRecords": "没有找到符合条件的数据",
					"sProcessing": "&lt;imgsrc=’./loading.gif’ /&gt;",
					"sInfo": "当前第 _START_ - _END_ 条　共计 _TOTAL_ 条",
					"sInfoEmpty": "没有记录",
					"sInfoFiltered": "(从 _MAX_ 条记录中过滤)",
					"sSearch": "搜索：",
					"oPaginate": {
					"sFirst": "首页",
					"sPrevious": "前一页",
					"sNext": "后一页",
					"sLast": "尾页"
				    }
		        }, 
		        tableTools: {
		        
		           fnRowSelected: function ( nodes ) {
                   var index=nodes[0]._DT_RowIndex;	
                   rowSelTr=index;
	               var data = table.row(index).data();
	               openEdit(data);
             },
            sRowSelect:'multi',
            
            aButtons: []
        },
        createdRow: function ( row, data, index ) {
           //绑定一列：第四列
           var v=$('td',row).eq(4).text();
           $('td',row).eq(4).darkTooltip({content:v,y_number:245});
        } 
    });	    
			//绑定事件 on
		    var table= $('#zuoxipeixun').DataTable();		    
		    	    			 
$.unblockUI();
		    		    		    
		});		
			function filterColumn(i){
			    $('#zuoxipeixun').DataTable().column(i).search($('#col'+i+'_filter').val()).draw();
			}
			function showSearchItems(){
				$("#searchItems").slideToggle(200);
			}
function openEdit(data){
			   $("#yijieshouxinxiEdit").show();
			   $("#titleE").val(data.title);
			   $("#abstractE").val(data.abstract);
			   $("#originalLinkE").val(data.originalLink);
			   $("#dataTimeE").val(data.dataTime);
			   $("#isReleaseE").val(data.isRelease);
			   $("#CategoryE").val(data.Category);
			   $("#autorE").val(data.autor);
			   $("#singleOrDoubleE").val(data.singleOrDouble);
			    //scroll2data("yijieshouxinxiEdit");
			 
			}
			
			function scroll2data(id){
				$("html,body").animate({scrollTop: $("#"+id).offset().top}, 1000); 
			}
		
			</script>
	</head>
	<body >
		<div class="z_container">
			<!-- datatable部分 包含筛选项 -->
			<div class="head">
				<!-- dataTable筛选项部分 -->
				<div class="widget-box collapsible">
					<div class="widget-title">
						<span class="icon"> <i class="icon-search"></i> </span>
						<h5>
							配置项搜索
						</h5>
						<div class="buttons">
							<button class="btn btn-mini"
								onclick="$('#collapseOne').slideToggle(200);">
								<i class="icon-retweet"></i>展开/关闭
							</button>
						</div>
					</div>
					<div class="collapse in" id="collapseOne">
						<!--TODO 里面写查询项表单布局 -->
						<div class="widget-content container">
							<form action="" id="find">

								<div class="row" style="margin-left: -200px">
									<div class="span4">
										<div class="form-horizontal">
											<!-- 日期 布局会遮住后面选择日期的按钮  临时同减小input宽度解决 -->
											<div class="control-group">
												<label class="control-label" for="msgImportLevel">
													标题:
												</label>
												<div class="controls">
													<input type="text" id="title" name="title"
														data-sType="like">
												</div>
											</div>
										</div>
									</div>
									<div class="span4 offset1">
										<div class="form-horizontal">
											<div class="control-group">
												<label class="control-label" for="msgImportLevel">
													作者:
												</label>
												<div class="controls">
													<input type="text" id="autor" name="autor"
														data-sType="like">
												</div>
											</div>
										</div>
									</div>
									<div class="span4 offset1">
										<div class="form-horizontal">
											<div class="control-group">
												<label class="control-label" for="msgImportLevel">
													类别:
												</label>
												<div class="controls">
													<select name="Category1" id="Category1">
														
													</select>
												</div>
											</div>
										</div>
									</div>
								</div>

							</form>
							<center>
								&nbsp;&nbsp;&nbsp;&nbsp;
								<button type="button" id="btn_search" class="btn"
									onclick="doSearch1()">
									<i class="icon-search"></i> 搜索
								</button>
								&nbsp;&nbsp;
								<button type="button" id="btn_clean" class="btn"
									onclick="chongzhi();">
									<i class="icon-remove"></i> 清空
								</button>
							</center>
						</div>
					</div>
				</div>
				<!-- dataTable 部分 -->
				<div class="widget-box">
					<div class="widget-title">
						<span class="icon"> <i class="icon-th"></i> </span>
						<h5>
							信息
						</h5>
						<!--TODO 里面可加一些按钮 -->
						<div class="buttons">
							<!--  <a class="btn btn-mini" onclick="refresh()" href="javascript:;;"><i
								class="icon-refresh"></i> 刷 新</a>-->
						</div>
					</div>
					<div class="widget-content nopadding">
						<!-- 提示栏 -->
						<div class="alert alert-error" id="errorDiv"
							style="display: none;">
						</div>
						<div class="alert alert-success" id="successDiv"
							style="display: none;">

						</div>
						<table id="zuoxipeixun"
							class="table table-striped table-bordered nowrap">

						</table>

					</div>

				</div>
			</div>
			<!-- 表单部分 -->
			<div class="foot ">
				<div class="widget-box " style="margin-top: 0px">
					<!-- 功能栏 -->
					<div class="navbar-inner" style="padding-top: 10px">
						<button class="btn btn-primary" onclick="add_dan();">
							添加单图文
						</button>
						&nbsp;
						<button class="btn btn-primary" onclick="add();">
							添加多图文
						</button>
						&nbsp;
						<button class="btn btn-danger" onclick="doDelte();">
							删 除
						</button>
						&nbsp;
						<button class="btn btn-primary" onclick="doFabu();">
							发布
						</button>
						&nbsp;
						<button class="btn btn-primary" onclick="doQuxiaofabu();">
							取消发布
						</button>
					</div>
					<!-- 表单项  update insert 先用一个表单 有需要就分开 -->

				
				<div id="yijieshouxinxiEdit" class="widget-content container"
					style="display: none">
					<form id="zuoxipeixunEditForm">
						<input type="hidden" name="id">
						<div class="row" style="margin-left: -200px">
							<div class="span4 ">
								<div class="form-horizontal">
									<div class="control-group">
										<label class="control-label" for="inputEmail">
											标题:
										</label>
										<div class="controls">
											<input type="text" id="titleE" name="title"
												 />
										</div>
									</div>
								</div>
							</div>
							<div class="span4 offset1">
								<div class="form-horizontal">
									<div class="control-group">
										<label class="control-label" for="inputEmail">
											作者:
										</label>
										<div class="controls">
											<input type="text" id="autorE" name="autor"
												/>
										</div>
									</div>
								</div>
							</div>
							<div class="span4 offset1">
								<div class="form-horizontal">
									<div class="control-group">
										<label class="control-label" for="inputEmail">
											图文类型:
										</label>
										<div class="controls">
											<input type="text" id="singleOrDoubleE" name="singleOrDouble"/>
										</div>
									</div>
								</div>
							</div>
						</div>
						<div class="row" style="margin-left: -200px">
							<div class="span4">
								<div class="form-horizontal">
									<div class="control-group">
										<label class="control-label" for="readFlag">
											所属类别:
										</label>
										<div class="controls">
											<input type="text" id="CategoryE" name="Category"/>
										</div>
									</div>
								</div>
							</div>
							<div class="span4 offset1">
								<div class="form-horizontal">
									<div class="control-group">
										<label class="control-label" for="readFlag">
											是否发布:
										</label>
										<div class="controls">
											<input type="text" id="isReleaseE" name="isRelease"/>
										</div>
									</div>
								</div>
							</div>
							<div class="span4 offset1">
								<div class="form-horizontal">
									<div class="control-group">
										<label class="control-label" for="msgId">
											时间:
										</label>
										<div class="controls">
											<input type="text" id="dataTimeE" name="dataTime"/>
										</div>
									</div>
								</div>
							</div>
						</div>

						<div class="row" style="margin-left: -200px">
							<div class="span4 ">
								<div class="form-horizontal">
									<div class="control-group">
										<label class="control-label" for="msgContent">
											原文链接:
										</label>
										<div class="controls">
											<textarea id="originalLinkE" name="originalLink"
												></textarea>
										</div>
									</div>
								</div>
							</div>
							<div class="span4 offset1">
								<div class="form-horizontal">
									<div class="control-group">
										<label class="control-label" for="inputEmail">
											摘要:
										</label>
										<div class="controls">
											<textarea id="abstractE" name="abstract"
												></textarea>
										</div>
									</div>
								</div>
							</div>
						</div>	
							
					</form>
				</div>			</div>
		</div>
		
	</body>
</html>