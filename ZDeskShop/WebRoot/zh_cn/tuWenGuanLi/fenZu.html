
<!DOCTYPE  HTML>
<html>
	<head>
		<title>分组管理</title>
		<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
		<link rel="stylesheet" href="../../css/bootstrap.min.css" type="text/css" />
		<link rel="stylesheet" href="../../js/bootstrap-datetimepicker/css/bootstrap-datetimepicker.css" type="text/css"></link>
		<link rel="stylesheet" href="../../js/dataTables/css/jquery.dataTables.css" type="text/css" />
		<!--[if lt IE 9]>
		<script type="text/javascript" src="../../js/html5shiv.min.js"></script>
		<![endif]-->
		<link rel="stylesheet" href="../../js/dataTables/css/DT_bootstrap.css" type="text/css" />
		<link rel="stylesheet" href="../../js/dataTables/css/dataTables.tableTools.min.css" type="text/css" />
		<!-- ZDesk 通用css  -->
		<link rel="stylesheet" href="../../css/zinglabs.css" type="text/css" />
		<link rel="stylesheet" href="../../js/dataTables/css/font-awesome.css" />
		<link rel="stylesheet" href="../../js/dataTables/css/dataTables.colVis.min.css" type="text/css" />
		<link rel="stylesheet" href="../../js/ueditor/themes/default/css/ueditor.css" />
		<script type="text/javascript" src="../../js/jquery.js"></script>
		<script type="text/javascript" src="../../js/bootstrap.js"></script>
		<script type="text/javascript" src="../../js/dataTables/js/jquery.dataTables.js"></script>
		<script type="text/javascript" src="../../js/dataTables/js/dataTables.colReorder.js"></script>
		<script type="text/javascript" src="../../js/dataTables/js/dataTables.colVis.js"></script>
		<script type="text/javascript" src="../../js/dataTables/js/dataTables.tableTools.min.js"></script>
		<script type="text/javascript" charset="utf-8" src="../../js/ueditor/ueditor.config.js"></script>
		<script type="text/javascript" charset="utf-8" src="../../js/ueditor/ueditor.all.js"> </script>
		<!--建议手动加在语言，避免在ie下有时因为加载语言失败导致编辑器加载失败-->
		<!--这里加载的语言文件会覆盖你在配置项目里添加的语言类型，比如你在配置项目里配置的是英文，这里加载的中文，那最后就是中文-->
		<script type="text/javascript" charset="utf-8"
			src="../../js/ueditor/lang/zh-cn/zh-cn.js"></script>

		<script type="text/javascript" src="../../js/common_utils.js"></script>
		<script type="text/javascript" src="../../js/appCommonUtil.js"></script>
		<script type="text/javascript" src="../../js/appCommonCurdUtils_new.js"></script>
		<script type="text/javascript" src="../../js/dataTables/js/DT_bootstrap.js"></script>
		<script type="text/javascript" src="../../js/bootstrap-datetimepicker/bootstrap-datetimepicker.min.js"></script>
		<script type="text/javascript" src="../../js/bootstrap-datetimepicker/bootstrap-datetimepicker.zh-CN.js"></script>

		<script type="text/javascript" src="../../js/log2.js"></script>
		<!-- 遮罩产插件 -->
		<script type="text/javascript" src="../../js/jquery.blockUI.js"></script>
		<!-- 验证及提示组件 -->
		<script type="text/javascript" src="../../js/jqueryValidate/jquery.validate.js"></script>
		<style type="text/css">
/*解决时间控件在模式对话框中的显示问题**/
.error {
	border-color: red !important;
}

.datetimepicker {
	z-index: 99999 !important;
}

.bootstrap-datetimepicker-widget {
	z-index: 99999 !important;
}

/*临时解决datatable单元格变形问题  为保证宽度不变，ie兼容模式显示效果为换行 其它浏览器省略号
  需要通过只显示部分原文解决此问题
*/
.dataTable th,.dataTable td {
	width: 120px;
	max-width: 120px;
	overflow: hidden;
	text-overflow: ellipsis;
	white-space: nowrap;
}
</style>

		<script type="text/javascript">
//遮罩属性		
var maskContent = {
		css : {
			border : 'none',
			padding : '15px',
			backgroundColor : '#000',
			'-webkit-border-radius' : '10px',
			'-moz-border-radius' : '10px',
			opacity : .5,
			color : '#fff',
			font : '14px'
		},
		message : '<img src="../../img/wait.gif" border="0" />  正在加载中，请稍候...'
	};
var yijieshouxinxiCurdStatus="false";
var fullTableName="pictureLibrary";
var rowSelTr=false;
var myEditorImage;
var d;
var imageName;
var uploadImageName;
var imageUrl;
var imagePhysicalPath;
var genusGroup;
var uploadPeople;
$(document).ready(function() {
	getGroup();
});



/***
 * @TODO
 * 通用，调试完成后分文件，不要加Velocity代码
 */

function doDelete(){
	
    var params = {};
		params.tableName="pictureLibrary";
		params.columnValues={"isDelete":"1","id":$("#id").val()};
		commonUpdate(params,false,function(data){
			if(data && data.success){
				doSearch();
				alert("数据删除成功！");
			}else{
				alert("数据删除失败！");
			}
	    });
};

/***
 *
 * @desc 指定panel赋值 和清空
 * @todo 只测试了主要类型 , checkbox、radio没测试
 *
 * pVars.id panel id
 * pVars.data 赋值数据
 * pVars.isClear 字符串 "true" 清空此panel
 *
 *
 * @TODO
 * 通用，调试完成后分文件，不要加Velocity代码
 *
 */
function setPanelVal(pVars){
    $('#'+pVars.id+' :input').each(function(index,obj) {
        var type = obj.type;
        var tag = obj.tagName.toLowerCase();
        if(("isClear" in pVars) && pVars.isClear=='true'){
            if (type == 'text' || type == 'password' || tag == 'textarea' || type=='hidden')
                $(obj).val('');
            else if (type == 'checkbox' || type == 'radio')
                $(obj).attr('checked',false);
            else if (tag == 'select')
                $(obj).attr('selectedIndex',-1);
        }else{
            var vTmp=pVars.data[this.name];
            if(BIsNullVal(vTmp)){
                vTmp='';
            }
            if (type == 'text' || type == 'password'||type=='hidden' || tag == 'textarea')
                $(obj).val(vTmp);
            else if (type == 'checkbox' || type == 'radio'){
                $(obj).attr('checked',vTmp==''?false:vTmp);
            }
            else if (tag == 'select'){
                $(obj).attr('selectedIndex',vTmp==''?-1:vTmp);
            }
        }
    });
}
//每页显示条数
function setPageNum(obj){
    var table=$('#dataGrid').DataTable();
    table.page.len(obj.value).draw();
}
//刷新
function refresh(){
    $("#searchDataForm")[0].reset();
    doSearch();
}




/***
 * @TODO
 * 通用，调试完成后分文件，不要加Velocity代码
 */
function BIsNullVal(value) {
    return typeof(value)=="undefined" || value==null ||  (typeof(value)=='string' &&(value=="undefined" || value=='' || value=='null' )) ||  (typeof(value)=='boolean' &&value==false  );
};

/***
 * 必须处理的严重错误，测试阶段可以alert 生产环境特殊标识写入日志
 * 发现就要分析原因
 * @param err
 */
function logErr(errMsg) {
    log.debug(errMsg);
//    alert(errMsg);
//    PT().log.error(errMsg);
};



//显示错误信息
function showError(mgs){
  //$("#errorDiv").show();
  //  $("#successDiv").hide();
  //  $("#errorDiv").html(mgs);
  //  setTimeout(function(){
  //    $("#errorDiv").hide();
  // },3000);
    zinglabs.alert(mgs);

}
//显示成功信息
function showSuccess(mgs){
  //  $("#errorDiv").hide();
  // $("#successDiv").show();
  //  $("#successDiv").html(mgs);
 //  setTimeout(function(){
  //     $("#successDiv").hide();
 //  },3000);
 zinglabs.alert(mgs);
}
//获取组信息
function getGroup(){
	var params = {};
		params.tableName="categoryGroup";
	commonSelect(params,false,function(data){
		if(data && data.success){
			$("#categoryGroup").empty();
			$("#categoryGroup").append("<option value=''></option>");
			for(var o in data.data){
				$("#categoryGroup").append("<option value='"+data.data[o].id+"'>"+data.data[o].categoryValue+"</option>");
			}
		}else{
			alert(data.mgs);
		}			
	});
}
//添加组
function addGroup(){
	$("#divForAddGroup").slideDown(300);
	$("#btn_addGroup").hide(200);
}
//提交组数据
function comintGroup(){
	var params = {};
		params.tableName="categoryGroup";
		params.columnValues={"categoryKey":"","categoryValue":$("#categoryValue").val(),"createPeople":"admin","createTime":fomateDate("YYYY-MM-dd hh:mm:ss",new Date())};
		commonInsertOrUpdate(params,false,function(data){
			if(data && data.success){
				getGroup();
				cancelAddGroup();
				zinglabs.alert("创建分类成功！");
				$("#categoryValue").val('');
			}else{
				zinglabs.alert(data.mgs);
			}
	    });
	
}
//取消创建分组
function cancelAddGroup(){
	$("#divForAddGroup").hide(300);
	$("#btn_addGroup").show(200);
}
//删除分组
function deleteGroup(){
	var groupID=$("#categoryGroup option:selected").val();
	if(groupID==undefined || groupID==""){
		zinglabs.alert("未分类选项不允许删除！");
		return;
	}
	var params = {};
		params.tableName="categoryGroup";
		params.columnValues=groupID;
		commonDelete (params,false,function(data){
			if(data && data.success){
				getGroup();
				zinglabs.alert("删除类别成功！");
			}else{
				zinglabs.alert("删除类别失败！");
			}
    	});
	
}




    </script>
	</head>
	<body>

		<!-- 容器 -->
		<div class="z_container">
			<!-- datatable部分 包含筛选项 -->
			<div class="head">
				<!-- dataTable筛选项部分 -->
				<div class="widget-box collapsible">
					<div class="widget-title">
						<span class="icon"> <i class="icon-search"></i> </span>
						<h5>
							配置项搜索
						</h5>
						<div class="buttons">
							<button class="btn btn-mini" onclick="$('#collapseOne').slideToggle(200);">
								<i class="icon-retweet"></i>展开/关闭
							</button>
						</div>
					</div>
					<div class="collapse in" id="collapseOne">
							<form action="" id="searchDataForm">
								<div style="width:100%;">
									<table style="margin-top:20px;">
										<tr>
											<td>&nbsp;&nbsp;类别:</td>
											<td>
												<select id="categoryGroup" name="categoryGroup" style="margin-bottom:0px;">
													
												</select>
											</td>
											<td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
												<button type="button" id="btn_addGroup" class="btn" onclick="addGroup()">
													<i class="icon-plus"></i> 添加新类别
												</button>
											</td>
											<td>
												<button type="button" id="btn_deleteGroup" class="btn" onclick="deleteGroup()">
													<i class="icon-minus"></i> 删除类别
												</button>
											</td>
										</tr>
									</table>
								</div>
							</form>
								<div id="divForAddGroup" style="width:100%;margin-bottom:20px;display:none;">
									<table>
										<tr>	
											<td>&nbsp;&nbsp;类别:</td>										
											<td>
												<input type="text" id="categoryValue" name="categoryValue" style="margin-bottom:0px;"/>
											</td>
											<td>&nbsp;</td>
											<td>	
												&nbsp;&nbsp;&nbsp;											
												<button type="button" id="btn_comintGroup" class="btn" onclick="comintGroup()">
													提 交
												</button>
												<button type="button" id="btn_cancelAddGroup" class="btn" onclick="cancelAddGroup()">
													取 消
												</button>
											</td>
										</tr>
									</table>
								</div>
					</div>
				</div>
				<!-- dataTable 部分 -->
				
			</div>
			<!-- 表单部分 -->
			
</html>
